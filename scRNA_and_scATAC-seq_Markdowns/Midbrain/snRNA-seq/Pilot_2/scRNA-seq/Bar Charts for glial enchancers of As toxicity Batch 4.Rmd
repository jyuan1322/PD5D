---
title: "Bar Charts for glial enchancers of As toxicity Batch 4"
output: html_document
---


```{R, message=FALSE}
library(Seurat)
library(cowplot)
library(ggplot2)
library(ggsci)
library(dplyr)
library(psych)
library(pheatmap)
library(harmony)
#library(clusterProfiler)
#library(org.Hs.eg.db)
library(DOSE)
library(GOSemSim)
library(enrichplot)
library(stringr)
#library(reshape2)
```


```{R}

AllMB_group_assigned <- readRDS("Files/AllMB_Group_Assigned.rds")

AllMB_group_assigned_rawcounts <- AllMB_group_assigned@assays$RNA@counts

```


```{R}
AllMB_group_assigned_counts <- RelativeCounts(AllMB_group_assigned@assays$RNA@counts, scale.factor = 1e6, verbose = TRUE)

colnames(AllMB_group_assigned_counts) <- paste(AllMB_group_assigned@active.ident,AllMB_group_assigned@meta.data$case, sep = "_")

saveRDS(AllMB_group_assigned_counts, "Files/AllMB_case_group_assigned_counts_matrix.rds")
```


################################################################################


```{R, message=FALSE}
library(Seurat)
library(cowplot)
library(ggplot2)
library(ggsci)
library(dplyr)
library(psych)
library(pheatmap)
library(harmony)
#library(clusterProfiler)
#library(org.Hs.eg.db)
library(DOSE)
library(GOSemSim)
library(enrichplot)
library(stringr)
#library(reshape2)
```


```{R}

AllMB_group_assigned_counts_matrix <- readRDS("Files/AllMB_case_group_assigned_counts_matrix.rds")

```


```{R}
library(sciplot)

LRRK2_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "LRRK2"),]

clusters <- unique(names(LRRK2_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

LRRK2_mean <- unlist(lapply(clusters, meancluster, matrix=LRRK2_Counts))

LRRK2_sd <- unlist(lapply(clusters, sdcluster, matrix=LRRK2_Counts))

LRRK2_seom <- unlist(lapply(clusters, seomcluster, matrix=LRRK2_Counts))

LRRK2_se <- unlist(lapply(clusters, secluster, matrix=LRRK2_Counts))

LRRK2_table <- as.data.frame(cbind(LRRK2_mean,LRRK2_se,clusters))

LRRK2_table$Case <- str_sub(LRRK2_table$clusters,-2)

LRRK2_table$clusters <- gsub("_PD|_HC","",LRRK2_table$clusters)

colnames(LRRK2_table) <- c("mean","SE","clusters","Case")

LRRK2_table$SE <- as.numeric(LRRK2_table$SE)

LRRK2_table$mean <- as.numeric(LRRK2_table$mean)

LRRK2_table_subset <- LRRK2_table[LRRK2_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

LRRK2_table_subset$clusters <- factor(x=LRRK2_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(LRRK2_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("LRRK2") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
```

```{R}
LRRK2_bar_chart <- ggplot(LRRK2_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("LRRK2") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
        
ggsave(LRRK2_bar_chart, filename = "Figures/LRRK2_case_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


```{R}
library(sciplot)

RIT2_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "RIT2"),]

clusters <- unique(names(RIT2_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

RIT2_mean <- unlist(lapply(clusters, meancluster, matrix=RIT2_Counts))

RIT2_sd <- unlist(lapply(clusters, sdcluster, matrix=RIT2_Counts))

RIT2_seom <- unlist(lapply(clusters, seomcluster, matrix=RIT2_Counts))

RIT2_se <- unlist(lapply(clusters, secluster, matrix=RIT2_Counts))

RIT2_table <- as.data.frame(cbind(RIT2_mean,RIT2_se,clusters))

RIT2_table$Case <- str_sub(RIT2_table$clusters,-2)

RIT2_table$clusters <- gsub("_PD|_HC","",RIT2_table$clusters)

colnames(RIT2_table) <- c("mean","SE","clusters","Case")

RIT2_table$SE <- as.numeric(RIT2_table$SE)

RIT2_table$mean <- as.numeric(RIT2_table$mean)

RIT2_table_subset <- RIT2_table[RIT2_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

RIT2_table_subset$clusters <- factor(x=RIT2_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(RIT2_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("RIT2") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
```

```{R}
RIT2_bar_chart <- ggplot(RIT2_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("RIT2") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
        
ggsave(RIT2_bar_chart, filename = "Figures/RIT2_case_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


```{R}
library(sciplot)

GAK_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "GAK"),]

clusters <- unique(names(GAK_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

GAK_mean <- unlist(lapply(clusters, meancluster, matrix=GAK_Counts))

GAK_sd <- unlist(lapply(clusters, sdcluster, matrix=GAK_Counts))

GAK_seom <- unlist(lapply(clusters, seomcluster, matrix=GAK_Counts))

GAK_se <- unlist(lapply(clusters, secluster, matrix=GAK_Counts))

GAK_table <- as.data.frame(cbind(GAK_mean,GAK_se,clusters))

GAK_table$Case <- str_sub(GAK_table$clusters,-2)

GAK_table$clusters <- gsub("_PD|_HC","",GAK_table$clusters)

colnames(GAK_table) <- c("mean","SE","clusters","Case")

GAK_table$SE <- as.numeric(GAK_table$SE)

GAK_table$mean <- as.numeric(GAK_table$mean)

GAK_table_subset <- GAK_table[GAK_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

GAK_table_subset$clusters <- factor(x=GAK_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(GAK_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("GAK") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
```

```{R}

GAK_bar_chart <- ggplot(GAK_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("GAK") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
        
ggsave(GAK_bar_chart, filename = "Figures/GAK_case_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


```{R}
library(sciplot)

VPS13C_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "VPS13C"),]

clusters <- unique(names(VPS13C_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

VPS13C_mean <- unlist(lapply(clusters, meancluster, matrix=VPS13C_Counts))

VPS13C_sd <- unlist(lapply(clusters, sdcluster, matrix=VPS13C_Counts))

VPS13C_seom <- unlist(lapply(clusters, seomcluster, matrix=VPS13C_Counts))

VPS13C_se <- unlist(lapply(clusters, secluster, matrix=VPS13C_Counts))

VPS13C_table <- as.data.frame(cbind(VPS13C_mean,VPS13C_se,clusters))

VPS13C_table$Case <- str_sub(VPS13C_table$clusters,-2)

VPS13C_table$clusters <- gsub("_PD|_HC","",VPS13C_table$clusters)

colnames(VPS13C_table) <- c("mean","SE","clusters","Case")

VPS13C_table$SE <- as.numeric(VPS13C_table$SE)

VPS13C_table$mean <- as.numeric(VPS13C_table$mean)

VPS13C_table_subset <- VPS13C_table[VPS13C_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

VPS13C_table_subset$clusters <- factor(x=VPS13C_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(VPS13C_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("VPS13C") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
```

```{R}

VPS13C_bar_chart <- ggplot(VPS13C_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("VPS13C") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
        
ggsave(VPS13C_bar_chart, filename = "Figures/VPS13C_case_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```

```{R}
library(sciplot)

SLC1A2_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "SLC1A2"),]

clusters <- unique(names(SLC1A2_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

SLC1A2_mean <- unlist(lapply(clusters, meancluster, matrix=SLC1A2_Counts))

SLC1A2_sd <- unlist(lapply(clusters, sdcluster, matrix=SLC1A2_Counts))

SLC1A2_seom <- unlist(lapply(clusters, seomcluster, matrix=SLC1A2_Counts))

SLC1A2_se <- unlist(lapply(clusters, secluster, matrix=SLC1A2_Counts))

SLC1A2_table <- as.data.frame(cbind(SLC1A2_mean,SLC1A2_se,clusters))

SLC1A2_table$Case <- str_sub(SLC1A2_table$clusters,-2)

SLC1A2_table$clusters <- gsub("_PD|_HC","",SLC1A2_table$clusters)

colnames(SLC1A2_table) <- c("mean","SE","clusters","Case")

SLC1A2_table$SE <- as.numeric(SLC1A2_table$SE)

SLC1A2_table$mean <- as.numeric(SLC1A2_table$mean)

SLC1A2_table_subset <- SLC1A2_table[SLC1A2_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

SLC1A2_table_subset$clusters <- factor(x=SLC1A2_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(SLC1A2_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("SLC1A2") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
```

```{R}

SLC1A2_bar_chart <- ggplot(SLC1A2_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("SLC1A2") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
        
ggsave(SLC1A2_bar_chart, filename = "Figures/SLC1A2_case_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


```{R}
library(sciplot)

SLC1A3_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "SLC1A3"),]

clusters <- unique(names(SLC1A3_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

SLC1A3_mean <- unlist(lapply(clusters, meancluster, matrix=SLC1A3_Counts))

SLC1A3_sd <- unlist(lapply(clusters, sdcluster, matrix=SLC1A3_Counts))

SLC1A3_seom <- unlist(lapply(clusters, seomcluster, matrix=SLC1A3_Counts))

SLC1A3_se <- unlist(lapply(clusters, secluster, matrix=SLC1A3_Counts))

SLC1A3_table <- as.data.frame(cbind(SLC1A3_mean,SLC1A3_se,clusters))

SLC1A3_table$Case <- str_sub(SLC1A3_table$clusters,-2)

SLC1A3_table$clusters <- gsub("_PD|_HC","",SLC1A3_table$clusters)

colnames(SLC1A3_table) <- c("mean","SE","clusters","Case")

SLC1A3_table$SE <- as.numeric(SLC1A3_table$SE)

SLC1A3_table$mean <- as.numeric(SLC1A3_table$mean)

SLC1A3_table_subset <- SLC1A3_table[SLC1A3_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

SLC1A3_table_subset$clusters <- factor(x=SLC1A3_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(SLC1A3_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("SLC1A3") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
```

```{R}

SLC1A3_bar_chart <- ggplot(SLC1A3_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("SLC1A3") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
        
ggsave(SLC1A3_bar_chart, filename = "Figures/SLC1A3_case_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


```{R}
library(sciplot)

AQP4_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "AQP4"),]

clusters <- unique(names(AQP4_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

AQP4_mean <- unlist(lapply(clusters, meancluster, matrix=AQP4_Counts))

AQP4_sd <- unlist(lapply(clusters, sdcluster, matrix=AQP4_Counts))

AQP4_seom <- unlist(lapply(clusters, seomcluster, matrix=AQP4_Counts))

AQP4_se <- unlist(lapply(clusters, secluster, matrix=AQP4_Counts))

AQP4_table <- as.data.frame(cbind(AQP4_mean,AQP4_se,clusters))

AQP4_table$Case <- str_sub(AQP4_table$clusters,-2)

AQP4_table$clusters <- gsub("_PD|_HC","",AQP4_table$clusters)

colnames(AQP4_table) <- c("mean","SE","clusters","Case")

AQP4_table$SE <- as.numeric(AQP4_table$SE)

AQP4_table$mean <- as.numeric(AQP4_table$mean)

AQP4_table_subset <- AQP4_table[AQP4_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

AQP4_table_subset$clusters <- factor(x=AQP4_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(AQP4_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("AQP4") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
```

```{R}

AQP4_bar_chart <- ggplot(AQP4_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("AQP4") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
        
ggsave(AQP4_bar_chart, filename = "Figures/AQP4_chart_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


```{R}
library(sciplot)

P2RY12_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "P2RY12"),]

clusters <- unique(names(P2RY12_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

P2RY12_mean <- unlist(lapply(clusters, meancluster, matrix=P2RY12_Counts))

P2RY12_sd <- unlist(lapply(clusters, sdcluster, matrix=P2RY12_Counts))

P2RY12_seom <- unlist(lapply(clusters, seomcluster, matrix=P2RY12_Counts))

P2RY12_se <- unlist(lapply(clusters, secluster, matrix=P2RY12_Counts))

P2RY12_table <- as.data.frame(cbind(P2RY12_mean,P2RY12_se,clusters))

P2RY12_table$Case <- str_sub(P2RY12_table$clusters,-2)

P2RY12_table$clusters <- gsub("_PD|_HC","",P2RY12_table$clusters)

colnames(P2RY12_table) <- c("mean","SE","clusters","Case")

P2RY12_table$SE <- as.numeric(P2RY12_table$SE)

P2RY12_table$mean <- as.numeric(P2RY12_table$mean)

P2RY12_table_subset <- P2RY12_table[P2RY12_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

P2RY12_table_subset$clusters <- factor(x=P2RY12_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(P2RY12_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("P2RY12") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
```

```{R}

P2RY12_bar_chart <- ggplot(P2RY12_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("P2RY12") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
        
ggsave(P2RY12_bar_chart, filename = "Figures/P2RY12_case_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


```{R}
library(sciplot)

PLP1_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "PLP1"),]

clusters <- unique(names(PLP1_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

PLP1_mean <- unlist(lapply(clusters, meancluster, matrix=PLP1_Counts))

PLP1_sd <- unlist(lapply(clusters, sdcluster, matrix=PLP1_Counts))

PLP1_seom <- unlist(lapply(clusters, seomcluster, matrix=PLP1_Counts))

PLP1_se <- unlist(lapply(clusters, secluster, matrix=PLP1_Counts))

PLP1_table <- as.data.frame(cbind(PLP1_mean,PLP1_se,clusters))

PLP1_table$Case <- str_sub(PLP1_table$clusters,-2)

PLP1_table$clusters <- gsub("_PD|_HC","",PLP1_table$clusters)

colnames(PLP1_table) <- c("mean","SE","clusters","Case")

PLP1_table$SE <- as.numeric(PLP1_table$SE)

PLP1_table$mean <- as.numeric(PLP1_table$mean)

PLP1_table_subset <- PLP1_table[PLP1_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

PLP1_table_subset$clusters <- factor(x=PLP1_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(PLP1_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("PLP1") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
```


```{R}

PLP1_bar_chart <- ggplot(PLP1_table_subset, aes(x=clusters, y=mean, fill=Case)) +
        ggtitle("PLP1") +
        geom_bar(stat="identity", width=0.5,position=position_dodge()) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5)) +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.5))
        
        
ggsave(PLP1_bar_chart, filename = "Figures/PLP1_case_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


###################################################################################


```{R}

AllMB_group_assigned <- readRDS("Files/AllMB_Group_Assigned.rds")

```


```{R}
AllMB_group_assigned_counts <- RelativeCounts(AllMB_group_assigned@assays$RNA@counts, scale.factor = 1e6, verbose = TRUE)

colnames(AllMB_group_assigned_counts) <- paste(AllMB_group_assigned@active.ident)

saveRDS(AllMB_group_assigned_counts, "Files/AllMB_group_assigned_counts_matrix.rds")
```


################################################################################


```{R, message=FALSE}
library(Seurat)
library(cowplot)
library(ggplot2)
library(ggsci)
library(dplyr)
library(psych)
library(pheatmap)
library(harmony)
#library(clusterProfiler)
#library(org.Hs.eg.db)
library(DOSE)
library(GOSemSim)
library(enrichplot)
library(stringr)
#library(reshape2)
```


```{R}

AllMB_group_assigned_counts_matrix <- readRDS("Files/AllMB_group_assigned_counts_matrix.rds")

```


```{R}
library(sciplot)

LRRK2_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "LRRK2"),]

clusters <- unique(names(LRRK2_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

LRRK2_mean <- unlist(lapply(clusters, meancluster, matrix=LRRK2_Counts))

LRRK2_sd <- unlist(lapply(clusters, sdcluster, matrix=LRRK2_Counts))

LRRK2_seom <- unlist(lapply(clusters, seomcluster, matrix=LRRK2_Counts))

LRRK2_se <- unlist(lapply(clusters, secluster, matrix=LRRK2_Counts))

LRRK2_table <- as.data.frame(cbind(LRRK2_mean,LRRK2_se,clusters))

colnames(LRRK2_table) <- c("mean","SE","clusters")

LRRK2_table$SE <- as.numeric(LRRK2_table$SE)

LRRK2_table$mean <- as.numeric(LRRK2_table$mean)

LRRK2_table_subset <- LRRK2_table[LRRK2_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

LRRK2_table_subset$clusters <- factor(x=LRRK2_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```




```{R}
ggplot(LRRK2_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("LRRK2") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        




```


```{R}
LRRK2_bar_chart <- ggplot(LRRK2_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("LRRK2") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        
ggsave(LRRK2_bar_chart, filename = "Figures/LRRK2_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```

```{R}
library(sciplot)

RIT2_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "RIT2"),]

clusters <- unique(names(RIT2_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

RIT2_mean <- unlist(lapply(clusters, meancluster, matrix=RIT2_Counts))

RIT2_sd <- unlist(lapply(clusters, sdcluster, matrix=RIT2_Counts))

RIT2_seom <- unlist(lapply(clusters, seomcluster, matrix=RIT2_Counts))

RIT2_se <- unlist(lapply(clusters, secluster, matrix=RIT2_Counts))

RIT2_table <- as.data.frame(cbind(RIT2_mean,RIT2_se,clusters))

colnames(RIT2_table) <- c("mean","SE","clusters")

RIT2_table$SE <- as.numeric(RIT2_table$SE)

RIT2_table$mean <- as.numeric(RIT2_table$mean)

RIT2_table_subset <- RIT2_table[RIT2_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

RIT2_table_subset$clusters <- factor(x=RIT2_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}
ggplot(RIT2_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("RIT2") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))

```
```{R}
RIT2_bar_chart <- ggplot(RIT2_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("RIT2") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        
ggsave(RIT2_bar_chart, filename = "Figures/RIT2_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


```{R}
library(sciplot)

GAK_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "GAK"),]

clusters <- unique(names(GAK_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

GAK_mean <- unlist(lapply(clusters, meancluster, matrix=GAK_Counts))

GAK_sd <- unlist(lapply(clusters, sdcluster, matrix=GAK_Counts))

GAK_seom <- unlist(lapply(clusters, seomcluster, matrix=GAK_Counts))

GAK_se <- unlist(lapply(clusters, secluster, matrix=GAK_Counts))

GAK_table <- as.data.frame(cbind(GAK_mean,GAK_se,clusters))

colnames(GAK_table) <- c("mean","SE","clusters")

GAK_table$SE <- as.numeric(GAK_table$SE)

GAK_table$mean <- as.numeric(GAK_table$mean)

GAK_table_subset <- GAK_table[GAK_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

GAK_table_subset$clusters <- factor(x=GAK_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(GAK_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("GAK") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))

```
```{R}

GAK_bar_chart <- ggplot(GAK_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("GAK") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        
ggsave(GAK_bar_chart, filename = "Figures/GAK_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```

```{R}
library(sciplot)

VPS13C_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "VPS13C"),]

clusters <- unique(names(VPS13C_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

VPS13C_mean <- unlist(lapply(clusters, meancluster, matrix=VPS13C_Counts))

VPS13C_sd <- unlist(lapply(clusters, sdcluster, matrix=VPS13C_Counts))

VPS13C_seom <- unlist(lapply(clusters, seomcluster, matrix=VPS13C_Counts))

VPS13C_se <- unlist(lapply(clusters, secluster, matrix=VPS13C_Counts))

VPS13C_table <- as.data.frame(cbind(VPS13C_mean,VPS13C_se,clusters))

colnames(VPS13C_table) <- c("mean","SE","clusters")

VPS13C_table$SE <- as.numeric(VPS13C_table$SE)

VPS13C_table$mean <- as.numeric(VPS13C_table$mean)

VPS13C_table_subset <- VPS13C_table[VPS13C_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

VPS13C_table_subset$clusters <- factor(x=VPS13C_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(VPS13C_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("VPS13C") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))

```

```{R}

VPS13C_bar_chart <- ggplot(VPS13C_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("VPS13C") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        
ggsave(VPS13C_bar_chart, filename = "Figures/VPS13C_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```





```{R}
library(sciplot)

SLC1A2_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "SLC1A2"),]

clusters <- unique(names(SLC1A2_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

SLC1A2_mean <- unlist(lapply(clusters, meancluster, matrix=SLC1A2_Counts))

SLC1A2_sd <- unlist(lapply(clusters, sdcluster, matrix=SLC1A2_Counts))

SLC1A2_seom <- unlist(lapply(clusters, seomcluster, matrix=SLC1A2_Counts))

SLC1A2_se <- unlist(lapply(clusters, secluster, matrix=SLC1A2_Counts))

SLC1A2_table <- as.data.frame(cbind(SLC1A2_mean,SLC1A2_se,clusters))

colnames(SLC1A2_table) <- c("mean","SE","clusters")

SLC1A2_table$SE <- as.numeric(SLC1A2_table$SE)

SLC1A2_table$mean <- as.numeric(SLC1A2_table$mean)

SLC1A2_table_subset <- SLC1A2_table[SLC1A2_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

SLC1A2_table_subset$clusters <- factor(x=SLC1A2_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(SLC1A2_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("SLC1A2") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
```

```{R}

SLC1A2_bar_chart <- ggplot(SLC1A2_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("SLC1A2") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        
ggsave(SLC1A2_bar_chart, filename = "Figures/SLC1A2_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```

SLC1A3

```{R}
library(sciplot)

SLC1A3_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "SLC1A3"),]

clusters <- unique(names(SLC1A3_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

SLC1A3_mean <- unlist(lapply(clusters, meancluster, matrix=SLC1A3_Counts))

SLC1A3_sd <- unlist(lapply(clusters, sdcluster, matrix=SLC1A3_Counts))

SLC1A3_seom <- unlist(lapply(clusters, seomcluster, matrix=SLC1A3_Counts))

SLC1A3_se <- unlist(lapply(clusters, secluster, matrix=SLC1A3_Counts))

SLC1A3_table <- as.data.frame(cbind(SLC1A3_mean,SLC1A3_se,clusters))

colnames(SLC1A3_table) <- c("mean","SE","clusters")

SLC1A3_table$SE <- as.numeric(SLC1A3_table$SE)

SLC1A3_table$mean <- as.numeric(SLC1A3_table$mean)

SLC1A3_table_subset <- SLC1A3_table[SLC1A3_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

SLC1A3_table_subset$clusters <- factor(x=SLC1A3_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(SLC1A3_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("SLC1A3") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))

```

```{R}

SLC1A3_bar_chart <- ggplot(SLC1A3_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("SLC1A3") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        
ggsave(SLC1A3_bar_chart, filename = "Figures/SLC1A3_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```



```{R}
library(sciplot)

AQP4_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "AQP4"),]

clusters <- unique(names(AQP4_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

AQP4_mean <- unlist(lapply(clusters, meancluster, matrix=AQP4_Counts))

AQP4_sd <- unlist(lapply(clusters, sdcluster, matrix=AQP4_Counts))

AQP4_seom <- unlist(lapply(clusters, seomcluster, matrix=AQP4_Counts))

AQP4_se <- unlist(lapply(clusters, secluster, matrix=AQP4_Counts))

AQP4_table <- as.data.frame(cbind(AQP4_mean,AQP4_se,clusters))

colnames(AQP4_table) <- c("mean","SE","clusters")

AQP4_table$SE <- as.numeric(AQP4_table$SE)

AQP4_table$mean <- as.numeric(AQP4_table$mean)

AQP4_table_subset <- AQP4_table[AQP4_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

AQP4_table_subset$clusters <- factor(x=AQP4_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```

Neuron  = ENO2, RBFOX3
 Glutamatergic neurons = SLC17A6 (VGLUT2), SLC17A7 (VGLUT1)
 GABAergic neurons = SLC32A1 (VGAT), GAD1, GAD2
 Dopaminergic neurons = TH, SLC6A3, SCL18A2
 Astrocytes  = AQP4, GFAP
 Oligodendrocytes  =  PLP1, MBP
 OPCs  =  VCAN, BCAN,
 Microglia = CX3CR1, P2RY12
 Endothelial cells = FLT1, CLDN5

```{R}

ggplot(AQP4_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("AQP4") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))

```
```{R}

AQP4_bar_chart <- ggplot(AQP4_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("AQP4") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        
ggsave(AQP4_bar_chart, filename = "Figures/AQP4_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```


```{R}
library(sciplot)

P2RY12_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "P2RY12"),]

clusters <- unique(names(P2RY12_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

P2RY12_mean <- unlist(lapply(clusters, meancluster, matrix=P2RY12_Counts))

P2RY12_sd <- unlist(lapply(clusters, sdcluster, matrix=P2RY12_Counts))

P2RY12_seom <- unlist(lapply(clusters, seomcluster, matrix=P2RY12_Counts))

P2RY12_se <- unlist(lapply(clusters, secluster, matrix=P2RY12_Counts))

P2RY12_table <- as.data.frame(cbind(P2RY12_mean,P2RY12_se,clusters))

colnames(P2RY12_table) <- c("mean","SE","clusters")

P2RY12_table$SE <- as.numeric(P2RY12_table$SE)

P2RY12_table$mean <- as.numeric(P2RY12_table$mean)

P2RY12_table_subset <- P2RY12_table[P2RY12_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

P2RY12_table_subset$clusters <- factor(x=P2RY12_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(P2RY12_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("P2RY12") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))

```
```{R}

P2RY12_bar_chart <- ggplot(P2RY12_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("P2RY12") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        
ggsave(P2RY12_bar_chart, filename = "Figures/P2RY12_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")



```

```{R}
library(sciplot)

PLP1_Counts <- AllMB_group_assigned_counts_matrix[which(rownames(AllMB_group_assigned_counts_matrix) %in% "PLP1"),]

clusters <- unique(names(PLP1_Counts))

meancluster <- function(x,matrix) {
        meanval <- mean(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

sdcluster <- function(x,matrix) {
        meanval <- sd(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

seom <- function(x) sd(x)/sqrt(length(x))

seomcluster <- function(x,matrix) {
        meanval <- seom(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

secluster <- function(x,matrix) {
        meanval <- se(matrix[which(names(matrix) %in% x)])
        return(meanval)
}

PLP1_mean <- unlist(lapply(clusters, meancluster, matrix=PLP1_Counts))

PLP1_sd <- unlist(lapply(clusters, sdcluster, matrix=PLP1_Counts))

PLP1_seom <- unlist(lapply(clusters, seomcluster, matrix=PLP1_Counts))

PLP1_se <- unlist(lapply(clusters, secluster, matrix=PLP1_Counts))

PLP1_table <- as.data.frame(cbind(PLP1_mean,PLP1_se,clusters))

colnames(PLP1_table) <- c("mean","SE","clusters")

PLP1_table$SE <- as.numeric(PLP1_table$SE)

PLP1_table$mean <- as.numeric(PLP1_table$mean)

PLP1_table_subset <- PLP1_table[PLP1_table$clusters %in% c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"),]

PLP1_table_subset$clusters <- factor(x=PLP1_table_subset$clusters, levels = c("Astrocytes 1", "Astrocytes 2","Microglia","Oligodendrocytes","GLU/GABA Neurons","Dopaminergic Neurons"))
```



```{R}

ggplot(PLP1_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("PLP1") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))

```
```{R}

PLP1_bar_chart <- ggplot(PLP1_table_subset, aes(x=clusters, y=mean, fill=clusters)) +
        ggtitle("PLP1") +
        geom_bar(stat="identity", width=0.5) +
        ylab("Mean Counts per Million") +
        theme(axis.title.x = element_blank(),
              axis.text.x = element_text(angle = 65, hjust=1),
              plot.title = element_text(hjust = 0.5),
              legend.position = "none") +
        geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2,
                 position=position_dodge(.9))
        
        
ggsave(PLP1_bar_chart, filename = "Figures/PLP1_bar_chart_scRNA_seq_Batch4_Midbrain.pdf", device = "pdf", width = 4, height = 4, units = "in")

```


