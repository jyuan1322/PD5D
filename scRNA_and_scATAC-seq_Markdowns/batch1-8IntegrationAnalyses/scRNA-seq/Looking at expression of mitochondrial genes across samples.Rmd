---
title: "Looking at expression of mitochondrial genes across samples"
output: html_document
---


```{R, message=FALSE}
library(Seurat)
library(cowplot)
library(ggplot2)
library(ggsci)
library(dplyr)
library(psych)
library(pheatmap)
library(harmony)
#library(clusterProfiler)
#library(org.Hs.eg.db)
library(DOSE)
library(GOSemSim)
library(enrichplot)
library(sciplot)
library(reshape2)
library(MAST)
library(fgsea)
library(SeuratWrappers)
```

```{R, message=FALSE}

MtGenesTable <- read.table("Files/Mitochondrial_Gene_Expression_Tables/MTGenesAverageTable.tsv")

MtGenesTable <- MtGenesTable[-grep("ILB",MtGenesTable$Var1),]

Batches1to3Samples <- c("BN0009","BN0339","BN0341","BN0415","BN0329","BN0347","BN0348","BN0464","BN0602","BN0644","BN1855")

SampleGrep <- as.vector(MtGenesTable$Var1[grep(paste(Batches1to3Samples,collapse = "|"),unique(MtGenesTable$Var1))])
MtGenesTable$sample <- "4-8"
MtGenesTable$sample[MtGenesTable$Var1 %in% SampleGrep] <- "1-3"

PD <- as.vector(MtGenesTable$Var1[grep("PD",unique(MtGenesTable$Var1))])
MtGenesTable$status <- "Non-PD"
MtGenesTable$status[MtGenesTable$Var1 %in% PD] <- "PD"
MtGenesTable$Gene <- "Gene"
```



```{R}

MtGenesScatter <- ggplot(MtGenesTable, aes(x=Gene, y=value, color = status)) +
  geom_point(position = position_jitter(width = 0.1, height = 0.1)) +
  facet_grid(Var2~sample) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1))


ggsave("Figures/MtGenesScatter.pdf",MtGenesScatter, width = 4, height = 8, units = "in", device = "pdf")
```

```{R}

MtGenesScatter <- ggplot(MtGenesTable, aes(x=Gene, y=value, color = status)) +
  geom_point(position = position_jitter(width = 0.1, height = 0.1), size =0.5) +
  facet_wrap(~Var2, ncol = 3) +
  theme_bw() +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        strip.background = element_blank())


ggsave("Figures/Mitochondrial_Gene_Expression/MtGenesScatter.pdf",MtGenesScatter, width = 4, height = 8, units = "in", device = "pdf")


```


Trying Boxplots


```{R}

MtGenesBoxplot <- ggplot(MtGenesTable, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_grid(Var2~sample) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1))


ggsave("Figures/MtGenesBoxplot.pdf",MtGenesBoxplot, width = 4, height = 8, units = "in", device = "pdf")

MtGenesBoxplotAll <- ggplot(MtGenesTable, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_wrap(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1))


ggsave("Figures/MtGenesBoxplotAll.pdf",MtGenesBoxplotAll, width = 4, height = 8, units = "in", device = "pdf")


```


#####################################################################


Cluster Boxplots


```{R, message=FALSE}
library(Seurat)
library(cowplot)
library(ggplot2)
library(ggsci)
library(dplyr)
library(psych)
library(pheatmap)
library(harmony)
#library(clusterProfiler)
#library(org.Hs.eg.db)
library(DOSE)
library(GOSemSim)
library(enrichplot)
library(sciplot)
library(reshape2)
library(MAST)
library(fgsea)
library(SeuratWrappers)
```

```{R, message=FALSE}

MtGenesTable <- read.table("Files/MTGenesAverageTableClusters.tsv")

MtGenesTable <- MtGenesTable[-grep("ILB",MtGenesTable$Var1),]

Batches1to3Samples <- c("BN0009","BN0339","BN0341","BN0415","BN0329","BN0347","BN0348","BN0464","BN0602","BN0644","BN1855")

SampleGrep <- as.vector(MtGenesTable$Var1[grep(paste(Batches1to3Samples,collapse = "|"),unique(MtGenesTable$Var1))])
MtGenesTable$sample <- "4-8"
MtGenesTable$sample[MtGenesTable$Var1 %in% SampleGrep] <- "1-3"

PD <- as.vector(MtGenesTable$Var1[grep("PD",unique(MtGenesTable$Var1))])
MtGenesTable$status <- "Non-PD"
MtGenesTable$status[MtGenesTable$Var1 %in% PD] <- "PD"
MtGenesTable$Gene <- "Gene"
```


```{R}
MtGenesTableGlu <- MtGenesTable[grep("GLU_Neurons",MtGenesTable$Var1),]

MtGenesBoxGluplot <- ggplot(MtGenesTableGlu, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_grid(Var2~sample) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1))


ggsave("Figures/MtGenesBoxGluplot.pdf",MtGenesBoxGluplot, width = 4, height = 8, units = "in", device = "pdf")

MtGenesBoxGluplot <- ggplot(MtGenesTableGlu, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_wrap(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1))


ggsave("Figures/MtGenesBoxGluplotAll.pdf",MtGenesBoxGluplot, width = 4, height = 8, units = "in", device = "pdf")

MtGenesTableGluOldBatches <- MtGenesTableGlu[MtGenesTableGlu$sample %in% "1-3",]



MtGenesBoxplotGluOldBatches <- ggplot(MtGenesTableGluOldBatches, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_wrap(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1))


ggsave("Figures/MtGenesBoxGluplotAll1-3.pdf",MtGenesBoxplotGluOldBatches, width = 4, height = 8, units = "in", device = "pdf")
```

###########################################################################################################

Subcluster boxplots


```{R, message=FALSE}
library(Seurat)
library(cowplot)
library(ggplot2)
library(ggsci)
library(dplyr)
library(psych)
library(pheatmap)
library(harmony)
#library(clusterProfiler)
#library(org.Hs.eg.db)
library(DOSE)
library(GOSemSim)
library(enrichplot)
library(sciplot)
library(reshape2)
library(MAST)
library(fgsea)
library(SeuratWrappers)
```

```{R, message=FALSE}

MtGenesTable <- read.table("Files/MTGenesAverageSubClusterTable.tsv")

MtGenesTable <- MtGenesTable[-grep("ILB",MtGenesTable$Var1),]

Batches1to3Samples <- c("BN0009","BN0339","BN0341","BN0415","BN0329","BN0347","BN0348","BN0464","BN0602","BN0644","BN1855")

SampleGrep <- as.vector(MtGenesTable$Var1[grep(paste(Batches1to3Samples,collapse = "|"),unique(MtGenesTable$Var1))])
MtGenesTable$sample <- "4-8"
MtGenesTable$sample[MtGenesTable$Var1 %in% SampleGrep] <- "1-3"

PD <- as.vector(MtGenesTable$Var1[grep("PD",unique(MtGenesTable$Var1))])
MtGenesTable$status <- "Non-PD"
MtGenesTable$status[MtGenesTable$Var1 %in% PD] <- "PD"
MtGenesTable$Gene <- "Gene"
```


```{R}
MtGenesTableGlu_3 <- MtGenesTable[grep("GLU_Neurons_3",MtGenesTable$Var1),]

MtGenesBoxGlu_3_plot <- ggplot(MtGenesTableGlu_3, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_grid(Var2~sample) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1)) +
  stat_summary(fun.y="mean")


ggsave("Figures/MtGenesBoxGlu_3plot.pdf",MtGenesBoxGlu_3_plot, width = 4, height = 8, units = "in", device = "pdf")

MtGenesBoxGlu_3_plot <- ggplot(MtGenesTableGlu_3, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_wrap(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1)) +
  stat_summary(fun.y="mean")


ggsave("Figures/MtGenesBoxGlu_3plotAll.pdf",MtGenesBoxGlu_3_plot, width = 4, height = 8, units = "in", device = "pdf")

MtGenesTableGlu_3OldBatches <- MtGenesTableGlu_3[MtGenesTableGlu_3$sample %in% "1-3",]



MtGenesBoxplotGlu_3OldBatches <- ggplot(MtGenesTableGlu_3OldBatches, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_wrap(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1)) +
  stat_summary(fun.y="mean")


ggsave("Figures/MtGenesBoxGluplot_3All1-3.pdf",MtGenesBoxplotGlu_3OldBatches, width = 4, height = 8, units = "in", device = "pdf")
```



```{R}
MtGenesTableGlu_1 <- MtGenesTable[grep("GLU_Neurons_1",MtGenesTable$Var1),]

MtGenesBoxGlu_1_plot <- ggplot(MtGenesTableGlu_1, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_grid(Var2~sample) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1)) +
  stat_summary(fun.y="mean")


ggsave("Figures/MtGenesBoxGlu_1plot.pdf",MtGenesBoxGlu_1_plot, width = 4, height = 8, units = "in", device = "pdf")

MtGenesBoxGlu_1_plot <- ggplot(MtGenesTableGlu_1, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_wrap(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1)) +
  stat_summary(fun.y="mean")


ggsave("Figures/MtGenesBoxGlu_1plotAll.pdf",MtGenesBoxGlu_1_plot, width = 4, height = 8, units = "in", device = "pdf")

MtGenesTableGlu_1OldBatches <- MtGenesTableGlu_1[MtGenesTableGlu_1$sample %in% "1-3",]



MtGenesBoxplotGlu_1OldBatches <- ggplot(MtGenesTableGlu_1OldBatches, aes(x=Gene, y=value, color = status)) +
  geom_boxplot() +
  facet_wrap(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1)) +
  stat_summary(fun.y="mean")


ggsave("Figures/MtGenesBoxGluplot_1All1-3.pdf",MtGenesBoxplotGlu_1OldBatches, width = 4, height = 8, units = "in", device = "pdf")
```

#############################################################################################################################

Repeating but not splitting by sample for all samples and samples 1-3 to get more accurate results


```{R, message=FALSE}
library(Seurat)
library(cowplot)
library(ggplot2)
library(ggsci)
library(dplyr)
library(psych)
library(pheatmap)
library(harmony)
#library(clusterProfiler)
#library(org.Hs.eg.db)
library(DOSE)
library(GOSemSim)
library(enrichplot)
library(sciplot)
library(reshape2)
library(MAST)
library(fgsea)
library(SeuratWrappers)
```

Reading in table for all samples and looking specifically at Glu Neurons 3

```{R, message=FALSE}

MtGenesTable <- read.table("Files/MTGenesAverageSubClusterTableNonSampleSplit.tsv", header = TRUE)

MtGenesTable <- MtGenesTable[-grep("ILB",MtGenesTable$Var1),]

#Batches1to3Samples <- c("BN0009","BN0339","BN0341","BN0415","BN0329","BN0347","BN0348","BN0464","BN0602","BN0644","BN1855")

#SampleGrep <- as.vector(MtGenesTable$Var1[grep(paste(Batches1to3Samples,collapse = "|"),unique(MtGenesTable$Var1))])
#MtGenesTable$sample <- "4-8"
#MtGenesTable$sample[MtGenesTable$Var1 %in% SampleGrep] <- "1-3"

PD <- as.vector(MtGenesTable$Var1[grep("PD",unique(MtGenesTable$Var1))])
MtGenesTable$status <- "Non-PD"
MtGenesTable$status[MtGenesTable$Var1 %in% PD] <- "PD"
MtGenesTable$Gene <- "Gene"
```




```{R}
MtGenesTableGlu_3 <- MtGenesTable[grep("GLU_Neurons_3",MtGenesTable$Var1),]

MtGenesGlu_3_Barplot <- ggplot(MtGenesTableGlu_3, aes(x=status, y=value, fill = status)) +
  geom_bar(stat="identity") +
  facet_grid(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1))


ggsave("Figures/MtGenesGlu_3AllSamplesNoSplitBarplot.pdf",MtGenesGlu_3_Barplot, width = 8, height = 4, units = "in", device = "pdf")

```


checking for mean across GLU_Neurons

```{R}
MtGenesTableGlu <- MtGenesTable[grep("GLU_Neurons",MtGenesTable$Var1),]

MtGenesTableGlu$Ident <- gsub("_HC|_PD","",MtGenesTableGlu$Var1)

#MtGenesTableGlu$Var1 <- gsub("_GLU_Neurons_[[:digit:]]+","_GLU_Neurons",MtGenesTableGlu$Var1)

MtGenesTableGluNeuronGrid <- ggplot(MtGenesTableGlu, aes(x=status, y=value, fill = status)) +
  geom_bar(stat="identity") +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1)) +
  facet_grid(Ident~Var2)

ggsave("Figures/MtGenesGluNeuronGrid_AllSamplesNoSplitBarplot.pdf",MtGenesTableGluNeuronGrid, width = 12, height = 16, units = "in", device = "pdf")

```
Reading in table for batches 1-3 and looking specifically at Glu Neurons 3


```{R, message=FALSE}

MtGenesTable <- read.table("Files/MTGenesSamples1to3AverageSubClusterTableNonSampleSplit.tsv", header = TRUE)

MtGenesTable <- MtGenesTable[-grep("ILB",MtGenesTable$Var1),]

#Batches1to3Samples <- c("BN0009","BN0339","BN0341","BN0415","BN0329","BN0347","BN0348","BN0464","BN0602","BN0644","BN1855")

#SampleGrep <- as.vector(MtGenesTable$Var1[grep(paste(Batches1to3Samples,collapse = "|"),unique(MtGenesTable$Var1))])
#MtGenesTable$sample <- "4-8"
#MtGenesTable$sample[MtGenesTable$Var1 %in% SampleGrep] <- "1-3"

PD <- as.vector(MtGenesTable$Var1[grep("PD",unique(MtGenesTable$Var1))])
MtGenesTable$status <- "Non-PD"
MtGenesTable$status[MtGenesTable$Var1 %in% PD] <- "PD"
MtGenesTable$Gene <- "Gene"
```


```{R}
MtGenesTableGlu_3 <- MtGenesTable[grep("GLU_Neurons_3",MtGenesTable$Var1),]

MtGenesGlu_3_Barplot <- ggplot(MtGenesTableGlu_3, aes(x=status, y=value, fill = status)) +
  geom_bar(stat="identity") +
  facet_grid(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1))


ggsave("Figures/MtGenesGlu_3Samples1to3NoSplitBarplot.pdf",MtGenesGlu_3_Barplot, width = 8, height = 4, units = "in", device = "pdf")

```


```{R}
MtGenesTableGlu_2 <- MtGenesTable[grep("GLU_Neurons_2",MtGenesTable$Var1),]

MtGenesGlu_2_Barplot <- ggplot(MtGenesTableGlu_2, aes(x=status, y=value, fill = status)) +
  geom_bar(stat="identity") +
  facet_grid(~Var2) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1))


ggsave("Figures/MtGenesGlu_2Samples1to3NoSplitBarplot.pdf",MtGenesGlu_2_Barplot, width = 8, height = 4, units = "in", device = "pdf")

```


checking for mean across GLU_Neurons

```{R}
MtGenesTableGlu <- MtGenesTable[grep("GLU_Neurons",MtGenesTable$Var1),]

MtGenesTableGlu$Ident <- gsub("HC_|PD_","",MtGenesTableGlu$Var1)

#MtGenesTableGlu$Var1 <- gsub("_GLU_Neurons_[[:digit:]]+","_GLU_Neurons",MtGenesTableGlu$Var1)

MtGenesTableGluNeuronGrid <- ggplot(MtGenesTableGlu, aes(x=status, y=value, fill = status)) +
  geom_bar(stat="identity") +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle = 65, hjust=1)) +
  facet_grid(Ident~Var2)

ggsave("Figures/MtGenesGluNeuronGrid_Samples1to3NoSplitBarplot.pdf",MtGenesTableGluNeuronGrid, width = 12, height = 16, units = "in", device = "pdf")

```


